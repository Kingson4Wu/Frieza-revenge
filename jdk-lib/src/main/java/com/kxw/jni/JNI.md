JNI使用流程

    a.编写带有native声明的方法的Java类

    b.使用javac命令编译编写的Java类

    c.使用java -jni ****来生成后缀名为.h的头文件

    d.使用其它语言（C、C++）实现本地方法

    e.将本地方法编写的文件生成动态链接库
    windows对应动态库为*.dll ，linux/unix对应动态库为 *.so ，mac os x对应动态库为 *.jnilib 
    
    
---
二、实践

1、编写类代码

package com.sunny.demo;

public class Demo01 {
        public native void hello();//没有实现

        static{
             System.loadLibrary("hello");//在类载入的 时候载入dll
          }

        public static void main(String[] args){

            new Demo01().hello();
         }

}

2、编译

javac com/sunny/demo/Demo01.java（注意，我这里是带包编译）

3、生成.h文件

javah -jni com.sunny.demo.Demo01(注意。头文件生成文件夹的位置。不知.java文件的位置，而在和包同级文件夹中，这里生成的文件名称为com_sunny_demo_Demo01.h)

4、用c实现hello方法（vc++6.0新建dllproject）

(1)当中com_sunny_demo_Demo01.h中代码例如以下(javah自己主动生成的)


/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class com_sunny_demo_Demo01 */

#ifndef _Included_com_sunny_demo_Demo01
#define _Included_com_sunny_demo_Demo01
#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     com_sunny_demo_Demo01
 * Method:    hello
 * Signature: ()V
 */
JNIEXPORT void JNICALL Java_com_sunny_demo_Demo01_hello
  (JNIEnv *, jobject);

#ifdef __cplusplus
}
#endif
#endif

(2).c文件，实现hello方法

#include<stdio.h>
#include"hello.h"
JNIEXPORT void JNICALL Java_com_sunny_demo_Demo01_hello(JNIEnv * a, jobject b){
	printf("hello world");
}
（3）用VC++6.0编译一下在debug文件夹中就生成好了dll文件。

说明：编译时假设产生例如以下错误：fatal error C1083: Cannot open include file: 'jni.h': No such file or directory。说明没有找到jni.h。到jdk的安装文件夹 include/jni.h;win32/jni_md.h;win32/jawt_md.h这3个文件复制到vc的安装文件夹include中

5.将dll放到生成.h的那一集文件夹中。执行java com.sunny.demo.Demo01就会出现例如以下结果




三、总结：

上面的样例中，我是带包编译的，所以文件存放和生成的位置一定要注意，在java层面我们仅仅须要dll文件，.h和.cd 文件的目的仅仅是为了生成dll文件.最后给出我代码的文件夹结果

.h文件是javah生成的，dll文件是应该放的位置（假设不放在这个位置。执行报错，找不到hello这个库）